---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---

```{r, echo = FALSE, results = 'hide', message = FALSE}
library(dplyr)
library(ggplot2)
```

## Loading and preprocessing the data
```{r, echo = TRUE}
unzip("activity.zip")
myData <- read.csv("activity.csv")
```

## What is mean total number of steps taken per day?
```{r, echo = TRUE, warning = FALSE, fig.height = 3}
stepsPerDay <- myData %>% 
    group_by(date) %>% 
    mutate(total = sum(steps)) %>% 
    select(date, total) %>% 
    unique()
meanStepsPerDay <- round(mean(stepsPerDay$total, na.rm = T))
medianStepsPerDay <- round(median(stepsPerDay$total, na.rm = T))

ggplot(data = stepsPerDay, aes(stepsPerDay$total)) + 
    geom_histogram(binwidth = 100) +
    labs(title = "Histogram: Total number of steps taken each day",
         x = "Total number of steps") 
```

The mean total number of steps taken per day is `r as.integer(meanStepsPerDay)` and the median total number of steps taken per day is `r as.integer(medianStepsPerDay)`.

## What is the average daily activity pattern?
```{r, echo = TRUE, fig.height = 3}
myDataPlot <- myData %>% 
    filter(steps != "NA") %>% 
    group_by(interval) %>% 
    mutate(mean = mean(steps)) %>% 
    select(interval, mean) %>% 
    unique()

intervalMax <- myDataPlot$interval[which(myDataPlot$mean == max(myDataPlot$mean))]

ggplot(data = myDataPlot, aes(x = interval, y = mean)) + 
  geom_line()
```

The 5-minute interval `r intervalMax`, on average across all the days in the dataset, contains the maximum number of steps.

## Imputing missing values



## Are there differences in activity patterns between weekdays and weekends?
